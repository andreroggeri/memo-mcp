# Implementation Plan: Helm Chart Deployment and Automation

**Branch**: `005-helm-chart-deployment` | **Date**: 2026-02-23 | **Spec**: [/specs/005-helm-chart-deployment/spec.md]
**Input**: Feature specification from `/specs/005-helm-chart-deployment/spec.md`

## Summary

Create a production-ready Helm chart for the `memo-mcp` server, configured to use SSE transport for Kubernetes compatibility. Implement automated chart packaging and releasing using GitHub Actions and the `helm/chart-releaser-action`.

## Technical Context

**Language/Version**: TypeScript (Node.js 22 LTS - for the app), Helm v3 (for charts)  
**Primary Dependencies**: Helm, GitHub Actions, `helm/chart-releaser-action`  
**Storage**: N/A (Stateless MCP server)  
**Testing**: `helm lint`, `helm install` (local cluster validation)  
**Target Platform**: Kubernetes (Cloud or local like Kind/Minikube)  
**Project Type**: single project  
**Performance Goals**: SSE endpoint 99.9% availability  
**Constraints**: MUST use SSE transport mode (stdio is unsuitable for K8s services)  
**Scale/Scope**: Standard production-grade deployment manifests

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

- **P0 (Security)**: Ensure `values.yaml` does not contain hardcoded secrets; use Kubernetes Secrets for sensitive info. **PASS**
- **P1 (Protocol)**: SSE transport must correctly implement the MCP SSE specification. **PASS**
- **P2 (Integration)**: Plan includes verification of Helm deployment in a CI environment. **PASS**
- **P3 (ESM)**: App remains ESM; Helm chart structure is standard. **PASS**
- **P4 (Lint)**: Use `helm lint` and `hadolint` (for Dockerfile if touched). **PASS**

_Divergence Note_: Technical Mandate in Constitution specifies `stdio` transport. This feature explicitly overrides this to `sse` as per user instruction for Kubernetes compatibility.

_Post-Design Validation_: Design reflects standard Helm practices and ensures SSE transport configuration. **PASS**

## Project Structure

### Documentation (this feature)

```text
specs/005-helm-chart-deployment/
├── plan.md              # This file
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
charts/
└── memo-mcp/
    ├── Chart.yaml
    ├── values.yaml
    └── templates/
        ├── _helpers.tpl
        ├── deployment.yaml
        ├── service.yaml
        └── hpa.yaml (optional)

.github/
└── workflows/
    └── release-charts.yml
```

**Structure Decision**: Single project with a new `charts/` directory for Helm assets and a new GitHub Action workflow.

## Complexity Tracking

| Violation     | Why Needed                          | Simpler Alternative Rejected Because                      |
| ------------- | ----------------------------------- | --------------------------------------------------------- |
| SSE Transport | Required for K8s service networking | stdio transport cannot be exposed via K8s Service/Ingress |
